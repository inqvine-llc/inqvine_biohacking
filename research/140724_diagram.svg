<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 2400">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#000"/>
    </marker>
  </defs>
  
  <text x="600" y="40" font-size="30" font-weight="bold" text-anchor="middle">Final Smart Limb and Coat System</text>
  
  <!-- Supportive Garment and Integrated Limb -->
  <g transform="translate(50,80)">
    <text x="0" y="20" font-size="22" font-weight="bold">Integrated Smart Coat and Limb</text>
    
    <!-- Dog body outline -->
    <path d="M100,100 C150,50 350,50 400,100 L420,300 C370,350 130,350 80,300 Z" fill="#e6e6e6" stroke="#000" stroke-width="2"/>
    <ellipse cx="450" cy="150" rx="50" ry="30" fill="#e6e6e6" stroke="#000"/> <!-- Head -->
    
    <!-- Limb openings -->
    <circle cx="150" cy="120" r="20" fill="#fff" stroke="#000"/>
    <circle cx="350" cy="120" r="20" fill="#fff" stroke="#000"/>
    <circle cx="150" cy="280" r="20" fill="#fff" stroke="#000"/>
    <circle cx="350" cy="280" r="20" fill="#fff" stroke="#000"/>
    
    <!-- Smart Limb (front right) -->
    <path d="M350,120 C370,140 380,200 375,250 C372,280 368,300 350,320" fill="none" stroke="#888" stroke-width="10"/>
    <circle cx="350" cy="120" r="15" fill="#ddd" stroke="#000"/> <!-- Shoulder joint -->
    <circle cx="372" cy="200" r="12" fill="#ddd" stroke="#000"/> <!-- Elbow joint -->
    <path d="M345,320 C355,325 360,330 350,335" fill="#faa" stroke="#000"/> <!-- Paw -->
    
    <!-- Integrated components visualization -->
    <rect x="200" y="150" width="100" height="60" fill="#add8e6" stroke="#000" opacity="0.7"/>
    <text x="250" y="175" font-size="14" text-anchor="middle">Integrated</text>
    <text x="250" y="190" font-size="14" text-anchor="middle">Electronics</text>
    <text x="250" y="205" font-size="12" text-anchor="middle">(MCU, Battery, Sensors)</text>
    
    <!-- E3K Module placement -->
    <rect x="220" y="230" width="60" height="40" fill="#99ccff" stroke="#000" opacity="0.7"/>
    <text x="250" y="255" font-size="12" text-anchor="middle">E3K Module</text>
    
    <!-- Annotations -->
    <line x1="450" y1="150" x2="550" y2="100" stroke="#000" marker-end="url(#arrowhead)"/>
    <text x="560" y="95" font-size="14" text-anchor="start">Integrated camera in headpiece</text>
    
    <line x1="250" y1="210" x2="550" y2="210" stroke="#000" marker-end="url(#arrowhead)"/>
    <text x="560" y="205" font-size="14" text-anchor="start">Core processing unit:</text>
    <text x="560" y="220" font-size="12" text-anchor="start">- AI-driven control system</text>
    <text x="560" y="235" font-size="12" text-anchor="start">- RAG/LLM for movement prediction</text>
    <text x="560" y="250" font-size="12" text-anchor="start">- Power management</text>
    
    <line x1="280" y1="250" x2="550" y2="280" stroke="#000" marker-end="url(#arrowhead)"/>
    <text x="560" y="275" font-size="14" text-anchor="start">E3K Biosensing Module:</text>
    <text x="560" y="290" font-size="12" text-anchor="start">- EMG, ECG, EEG monitoring</text>
    <text x="560" y="305" font-size="12" text-anchor="start">- Advanced signal processing</text>
    
    <line x1="350" y1="120" x2="550" y2="340" stroke="#000" marker-end="url(#arrowhead)"/>
    <text x="560" y="335" font-size="14" text-anchor="start">Smart Limb Features:</text>
    <text x="560" y="350" font-size="12" text-anchor="start">- High-torque shoulder servo</text>
    <text x="560" y="365" font-size="12" text-anchor="start">- Carbon fiber upper limb</text>
    <text x="560" y="380" font-size="12" text-anchor="start">- UHMWPE elbow joint</text>
    <text x="560" y="395" font-size="12" text-anchor="start">- TPU paw with pressure sensors</text>
  </g>
  
  <!-- Detailed Smart Limb Cross-Section -->
  <g transform="translate(50,550)">
    <text x="0" y="20" font-size="22" font-weight="bold">Smart Limb Cross-Section</text>
    
    <ellipse cx="250" cy="150" rx="100" ry="40" fill="#f0f0f0" stroke="#000"/>
    <line x1="150" y1="150" x2="350" y2="150" stroke="#000" stroke-width="2"/>
    
    <!-- Layers -->
    <path d="M160,130 Q250,100 340,130" fill="none" stroke="#ff9999" stroke-width="3"/>
    <text x="250" y="95" font-size="12" text-anchor="middle">Flexible outer layer (TPU)</text>
    
    <path d="M165,138 Q250,115 335,138" fill="none" stroke="#99ff99" stroke-width="3"/>
    <text x="250" y="110" font-size="12" text-anchor="middle">EMG sensor array</text>
    
    <rect x="180" y="140" width="140" height="10" fill="#9999ff" opacity="0.5"/>
    <text x="250" y="135" font-size="12" text-anchor="middle">Carbon fiber structure</text>
    
    <ellipse cx="250" cy="160" rx="60" ry="15" fill="#ffff99" opacity="0.5"/>
    <text x="250" y="165" font-size="12" text-anchor="middle">Servo motor</text>
    
    <path d="M190,170 Q250,190 310,170" fill="none" stroke="#ff99ff" stroke-width="3"/>
    <text x="250" y="195" font-size="12" text-anchor="middle">Force sensors and wiring</text>
  </g>
  
  <!-- AI and Control System (updated visualization) -->
  <g transform="translate(600,550)">
    <text x="0" y="20" font-size="22" font-weight="bold">AI-Driven Control System</text>
    
    <rect x="50" y="50" width="500" height="300" fill="none" stroke="#000"/>
    
    <!-- Data Input -->
    <rect x="70" y="70" width="100" height="60" fill="#add8e6" stroke="#000"/>
    <text x="120" y="95" font-size="14" text-anchor="middle">Sensor Data</text>
    <text x="120" y="110" font-size="12" text-anchor="middle">EMG, ECG, EEG</text>
    <text x="120" y="125" font-size="12" text-anchor="middle">Force, Position</text>
    
    <!-- AI Processing -->
    <rect x="250" y="70" width="120" height="260" fill="#90ee90" stroke="#000"/>
    <text x="310" y="90" font-size="16" text-anchor="middle" font-weight="bold">AI Processing</text>
    <text x="310" y="110" font-size="14" text-anchor="middle">1. Feature Extraction</text>
    <text x="310" y="130" font-size="14" text-anchor="middle">2. Machine Learning</text>
    <text x="310" y="150" font-size="14" text-anchor="middle">3. Movement Prediction</text>
    <text x="310" y="170" font-size="14" text-anchor="middle">4. Adaptive Control</text>
    <text x="310" y="190" font-size="14" text-anchor="middle">5. Error Correction</text>
    <text x="310" y="210" font-size="14" text-anchor="middle">6. Performance Optimization</text>
    
    <!-- Output -->
    <rect x="450" y="70" width="80" height="60" fill="#fffacd" stroke="#000"/>
    <text x="490" y="95" font-size="14" text-anchor="middle">Limb Control</text>
    <text x="490" y="110" font-size="12" text-anchor="middle">Commands</text>
    
    <!-- Data flow -->
    <line x1="170" y1="100" x2="240" y2="100" stroke="#000" marker-end="url(#arrowhead)"/>
    <line x1="370" y1="100" x2="440" y2="100" stroke="#000" marker-end="url(#arrowhead)"/>
    <path d="M 530,100 Q 550,200 310,320 Q 70,300 120,130" fill="none" stroke="#000" stroke-dasharray="5,5"/>
    <text x="400" y="300" font-size="14" text-anchor="middle">Feedback Loop</text>
  </g>
  
  <!-- RAG/LLM Movement Prediction System -->
  <g transform="translate(50,900)">
    <text x="0" y="20" font-size="22" font-weight="bold">RAG/LLM Movement Prediction System</text>
    
    <rect x="50" y="50" width="500" height="300" fill="none" stroke="#000"/>
    
    <!-- Historical Data -->
    <rect x="70" y="70" width="100" height="60" fill="#ffcccc" stroke="#000"/>
    <text x="120" y="95" font-size="14" text-anchor="middle">Historical Data</text>
    <text x="120" y="110" font-size="12" text-anchor="middle">Movement Patterns</text>
    
    <!-- RAG System -->
    <rect x="250" y="70" width="120" height="100" fill="#ccffcc" stroke="#000"/>
    <text x="310" y="90" font-size="16" text-anchor="middle" font-weight="bold">RAG System</text>
    <text x="310" y="110" font-size="14" text-anchor="middle">Retrieval of</text>
    <text x="310" y="125" font-size="14" text-anchor="middle">Relevant Patterns</text>
    
    <!-- LLM Processing -->
    <rect x="250" y="190" width="120" height="100" fill="#ccccff" stroke="#000"/>
    <text x="310" y="210" font-size="16" text-anchor="middle" font-weight="bold">LLM Processing</text>
    <text x="310" y="230" font-size="14" text-anchor="middle">Context-Aware</text>
    <text x="310" y="245" font-size="14" text-anchor="middle">Prediction</text>
    
    <!-- Predicted Movements -->
    <rect x="450" y="70" width="80" height="60" fill="#ffffcc" stroke="#000"/>
    <text x="490" y="95" font-size="14" text-anchor="middle">Predicted</text>
    <text x="490" y="110" font-size="14" text-anchor="middle">Movements</text>
    
    <!-- Arrows -->
    <line x1="170" y1="100" x2="240" y2="100" stroke="#000" marker-end="url(#arrowhead)"/>
    <line x1="310" y1="170" x2="310" y2="180" stroke="#000" marker-end="url(#arrowhead)"/>
    <line x1="370" y1="100" x2="440" y2="100" stroke="#000" marker-end="url(#arrowhead)"/>
  </g>
  
  <!-- E3K Module Detailed View -->
  <g transform="translate(600,900)">
    <text x="0" y="20" font-size="22" font-weight="bold">E3K Biosensing Module - Detailed View</text>
    
    <rect x="50" y="50" width="200" height="180" fill="#99ccff" stroke="#000"/>
    <text x="150" y="70" font-size="16" text-anchor="middle" font-weight="bold">E3K Module</text>
    
    <circle cx="100" cy="100" r="20" fill="#ff9999" stroke="#000"/>
    <text x="100" y="105" font-size="12" text-anchor="middle">EMG</text>
    
    <circle cx="150" cy="100" r="20" fill="#99ff99" stroke="#000"/>
    <text x="150" y="105" font-size="12" text-anchor="middle">ECG</text>
    
    <circle cx="200" cy="100" r="20" fill="#9999ff" stroke="#000"/>
    <text x="200" y="105" font-size="12" text-anchor="middle">EEG</text>
    
    <text x="150" y="140" font-size="14" text-anchor="middle">Integrated Biosensing</text>
    
    <rect x="75" y="160" width="150" height="50" fill="#ffffcc" stroke="#000"/>
    <text x="150" y="185" font-size="12" text-anchor="middle">Advanced Signal Processing</text>
    <text x="150" y="200" font-size="12" text-anchor="middle">Artifact Removal &amp; Noise Filtering</text>
    
    <!-- Features and Specifications -->
    <text x="300" y="70" font-size="14" text-anchor="start" font-weight="bold">Key Features:</text>
    <text x="300" y="90" font-size="12" text-anchor="start">- High-resolution muscle activity (EMG)</text>
    <text x="300" y="105" font-size="12" text-anchor="start">- Precise heart activity monitoring (ECG)</text>
    <text x="300" y="120" font-size="12" text-anchor="start">- Non-invasive brain activity sensing (EEG)</text>
    <text x="300" y="135" font-size="12" text-anchor="start">- Real-time data processing and analysis</text>
    <text x="300" y="150" font-size="12" text-anchor="start">- Wireless data transmission (Bluetooth LE)</text>
    <text x="300" y="165" font-size="12" text-anchor="start">- Low-power operation (up to 24h battery life)</text>
    <text x="300" y="180" font-size="12" text-anchor="start">- Machine learning-ready data output</text>
    <text x="300" y="195" font-size="12" text-anchor="start">- IP67 water and dust resistance</text>
    <text x="300" y="210" font-size="12" text-anchor="start">- Flexible, conforming design for comfort</text>
  </g>

  <!-- Materials Breakdown -->
  <g transform="translate(50,1250)">
    <text x="0" y="20" font-size="22" font-weight="bold">Materials Breakdown</text>
    
    <rect x="50" y="40" width="500" height="200" fill="none" stroke="#000"/>
    
    <text x="60" y="60" font-size="16" font-weight="bold">Coat Fabric:</text>
    <text x="70" y="80" font-size="14">- Base: Neoprene blend (flexibility, water resistance)</text>
    <text x="70" y="100" font-size="14">- Inner lining: Moisture-wicking polyester</text>
    <text x="70" y="120" font-size="14">- Outer layer: Rip-stop nylon (durability)</text>
    
    <text x="60" y="150" font-size="16" font-weight="bold">Smart Limb Components:</text>
    <text x="70" y="170" font-size="14">- Frame: Carbon fiber (lightweight strength)</text>
    <text x="70" y="190" font-size="14">- Joints: UHMWPE (durability, low friction)</text>
    <text x="70" y="210" font-size="14">- Actuators: Aluminum alloy (heat dissipation)</text>
    <text x="70" y="230" font-size="14">- Paw: TPU (flexibility, grip)</text>
  </g>

  <!-- Power Management System -->
  <g transform="translate(600,1250)">
    <text x="0" y="20" font-size="22" font-weight="bold">Power Management System</text>
    
    <rect x="50" y="40" width="500" height="200" fill="none" stroke="#000"/>
    
    <rect x="70" y="60" width="100" height="60" fill="#ffff99" stroke="#000"/>
    <text x="120" y="90" font-size="14" text-anchor="middle">Li-Ion Battery</text>
    <text x="120" y="105" font-size="12" text-anchor="middle">5000mAh, 7.4V</text>
    
    <rect x="250" y="60" width="120" height="60" fill="#99ffcc" stroke="#000"/>
    <text x="310" y="85" font-size="14" text-anchor="middle">Power Distribution</text>
    <text x="310" y="100" font-size="12" text-anchor="middle">&amp; Management IC</text>
    
    <rect x="450" y="60" width="80" height="60" fill="#ff99cc" stroke="#000"/>
    <text x="490" y="85" font-size="14" text-anchor="middle">Wireless</text>
    <text x="490" y="100" font-size="12" text-anchor="middle">Charging</text>
    
    <line x1="170" y1="90" x2="240" y2="90" stroke="#000" marker-end="url(#arrowhead)"/>
    <line x1="370" y1="90" x2="440" y2="90" stroke="#000" marker-end="url(#arrowhead)"/>
    
    <text x="60" y="140" font-size="14" font-weight="bold">Features:</text>
    <text x="70" y="160" font-size="12">- Intelligent power allocation based on activity</text>
    <text x="70" y="180" font-size="12">- Low-power modes for extended operation</text>
    <text x="70" y="200" font-size="12">- Quick-charge capability (0-80% in 45 minutes)</text>
    <text x="70" y="220" font-size="12">- Emergency power reserve for critical functions</text>
  </g>

  <!-- Limb-Specific Movement Prediction -->
  <g transform="translate(50,1500)">
    <text x="0" y="20" font-size="22" font-weight="bold">Limb-Specific Movement Prediction</text>
    
    <rect x="50" y="50" width="200" height="300" fill="none" stroke="#000"/>
    
    <!-- Shoulder -->
    <circle cx="150" cy="100" r="20" fill="#ffcccc" stroke="#000"/>
    <text x="150" y="105" font-size="12" text-anchor="middle">Shoulder</text>
    
    <!-- Upper Arm -->
    <rect x="140" y="130" width="20" height="60" fill="#ccffcc" stroke="#000"/>
    <text x="150" y="165" font-size="12" text-anchor="middle" transform="rotate(-90 150,165)">Upper Arm</text>
    
    <!-- Elbow -->
    <circle cx="150" cy="200" r="15" fill="#ccccff" stroke="#000"/>
    <text x="150" y="205" font-size="12" text-anchor="middle">Elbow</text>
    
    <!-- Lower Arm -->
    <rect x="140" y="225" width="20" height="60" fill="#ffffcc" stroke="#000"/>
    <text x="150" y="260" font-size="12" text-anchor="middle" transform="rotate(-90 150,260)">Lower Arm</text>
    
    <!-- Paw -->
    <rect x="135" y="295" width="30" height="20" fill="#ffccff" stroke="#000" rx="10"/>
    <text x="150" y="310" font-size="12" text-anchor="middle">Paw</text>
    
    <!-- Prediction Arrows and Boxes -->
    <line x1="180" y1="100" x2="270" y2="100" stroke="#000" marker-end="url(#arrowhead)"/>
    <rect x="280" y="85" width="120" height="30" fill="#f0f0f0" stroke="#000"/>
    <text x="340" y="105" font-size="12" text-anchor="middle">Shoulder Prediction</text>
    
    <line x1="180" y1="160" x2="270" y2="160" stroke="#000" marker-end="url(#arrowhead)"/>
    <rect x="280" y="145" width="120" height="30" fill="#f0f0f0" stroke="#000"/>
    <text x="340" y="165" font-size="12" text-anchor="middle">Upper Arm Prediction</text>
    
    <line x1="180" y1="200" x2="270" y2="200" stroke="#000" marker-end="url(#arrowhead)"/>
    <rect x="280" y="185" width="120" height="30" fill="#f0f0f0" stroke="#000"/>
    <text x="340" y="205" font-size="12" text-anchor="middle">Elbow Prediction</text>
    
    <line x1="180" y1="255" x2="270" y2="255" stroke="#000" marker-end="url(#arrowhead)"/>
    <rect x="280" y="240" width="120" height="30" fill="#f0f0f0" stroke="#000"/>
    <text x="340" y="260" font-size="12" text-anchor="middle">Lower Arm Prediction</text>
    
    <line x1="180" y1="305" x2="270" y2="305" stroke="#000" marker-end="url(#arrowhead)"/>
    <rect x="280" y="290" width="120" height="30" fill="#f0f0f0" stroke="#000"/>
    <text x="340" y="310" font-size="12" text-anchor="middle">Paw Prediction</text>
  </g>

  <!-- Safety and Fail-Safe Mechanisms -->
  <g transform="translate(600,1500)">
    <text x="0" y="20" font-size="22" font-weight="bold">Safety and Fail-Safe Mechanisms</text>
    
    <rect x="50" y="40" width="500" height="200" fill="none" stroke="#000"/>
    
    <text x="60" y="60" font-size="16" font-weight="bold">Emergency Shutdown:</text>
    <text x="70" y="80" font-size="14">- Instant motor disengagement</text>
    <text x="70" y="100" font-size="14">- Rapid depressurization of pneumatic elements</text>
    
    <text x="60" y="130" font-size="16" font-weight="bold">Overload Protection:</text>
    <text x="70" y="150" font-size="14">- Torque limiting on all servo motors</text>
    <text x="70" y="170" font-size="14">- Stress sensors in limb structure</text>
    
    <text x="60" y="200" font-size="16" font-weight="bold">Thermal Management:</text>
    <text x="70" y="220" font-size="14">- Active cooling system for high-load components</text>
    <text x="70" y="240" font-size="14">- Thermal cutoff switches</text>
  </g>

  <!-- Additional Notes -->
  <g transform="translate(50,1850)">
    <text x="0" y="20" font-size="22" font-weight="bold">Additional Design Considerations</text>
    <text x="20" y="50" font-size="16">1. Modularity: Easy component replacement and upgrades</text>
    <text x="20" y="80" font-size="16">2. Adaptive Calibration: Self-adjusting to individual gait patterns</text>
    <text x="20" y="110" font-size="16">3. Environmental Adaptation: Adjusts performance based on terrain</text>
    <text x="20" y="140" font-size="16">4. User Interface: Smartphone app for monitoring and basic control</text>
    <text x="20" y="170" font-size="16">5. Ethical Considerations: Data privacy and secure transmission</text>
  </g>
</svg>
